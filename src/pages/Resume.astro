---
import type { GitHubRepo } from '../types/github';
import ExperienceSection from '../components/ExperienceSection.astro';
import ProjectsSection from '../components/ProjectsSection.astro';
import HabilitiesSection from '../components/HabilitiesSection.astro';
import ContactSection from '../components/ContactSection.astro';
import AboutSection from '../components/AboutSection.astro';
import { applyLocale } from '@utils/locale';
import { t } from '@i18n/index';

interface Props {
	locale?: 'es' | 'en';
}

const providedLocale = (Astro.props as Props | undefined)?.locale;
const locale = providedLocale ?? applyLocale(Astro);
const response = await fetch(`${Astro.url}api/github-list.json`);
const repos: GitHubRepo[] = await response.json();
const projectsTitle = t('projects.title');
---

<AboutSection lang={locale} withJsonLd={true} />
<HabilitiesSection locale={locale} />
<ExperienceSection locale={locale} />
<ProjectsSection repos={repos} title={projectsTitle} locale={locale} />

<ContactSection locale={locale} />
